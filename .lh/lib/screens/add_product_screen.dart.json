{
    "sourceFile": "lib/screens/add_product_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1764487585808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764487591695,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,16 +1,15 @@\n import 'dart:io';\n \n import 'package:flutter/material.dart';\n import 'package:flutter_spinkit/flutter_spinkit.dart';\n-import 'package:form_field_validator/form_field_validator.dart';\n import 'package:image_picker/image_picker.dart';\n import 'package:provider/provider.dart';\n \n import '../providers/product_provider.dart';\n \n class AddProductScreen extends StatefulWidget {\n-  const AddProductScreen({Key? key}) : super(key: key);\n+  const AddProductScreen({super.key});\n \n   @override\n   State<AddProductScreen> createState() => _AddProductScreenState();\n }\n"
                },
                {
                    "date": 1764487639218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -136,9 +136,9 @@\n                 crossAxisAlignment: CrossAxisAlignment.stretch,\n                 children: [\n                   // Product Type Dropdown\n                   DropdownButtonFormField<String>(\n-                    value: _selectedProductType,\n+                    initialValue: _selectedProductType,\n                     hint: const Text('Select Product Type'),\n                     items: _productTypes.map((String type) {\n                       return DropdownMenuItem(value: type, child: Text(type));\n                     }).toList(),\n"
                },
                {
                    "date": 1764487646298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -172,9 +172,9 @@\n                       labelText: 'Selling Price',\n                       border: OutlineInputBorder(),\n                       prefixText: '₹ ',\n                     ),\n-                    keyboardType: TextInputType.numberWithOptions(\n+                    keyboardType: const TextInputType.numberWithOptions(\n                       decimal: true,\n                     ),\n                     validator: (value) => value == null || value.isEmpty\n                         ? 'Please enter price'\n@@ -189,9 +189,9 @@\n                       labelText: 'Tax Rate (%)',\n                       border: OutlineInputBorder(),\n                       suffixText: '%',\n                     ),\n-                    keyboardType: TextInputType.numberWithOptions(\n+                    keyboardType: const TextInputType.numberWithOptions(\n                       decimal: true,\n                     ),\n                     validator: (value) => value == null || value.isEmpty\n                         ? 'Please enter tax rate'\n"
                },
                {
                    "date": 1764491458162,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,48 +65,48 @@\n         _isUploading = false;\n       });\n \n       if (success) {\n-        // Show success dialog\n-        showDialog(\n-          context: context,\n-          builder: (BuildContext context) {\n-            return AlertDialog(\n-              title: const Text('Success'),\n-              content: const Text('Product added successfully!'),\n-              actions: [\n-                TextButton(\n-                  onPressed: () {\n-                    Navigator.of(context).pop();\n-                    Navigator.of(\n-                      context,\n-                    ).pop(true); // Return true to indicate success\n-                  },\n-                  child: const Text('OK'),\n-                ),\n-              ],\n-            );\n-          },\n-        );\n+        // Show success snackbar\n+        if (mounted) {\n+          ScaffoldMessenger.of(context).showSnackBar(\n+            const SnackBar(\n+              content: Text('Product added successfully!'),\n+              backgroundColor: Colors.green,\n+              duration: Duration(seconds: 2),\n+              behavior: SnackBarBehavior.floating,\n+              shape: RoundedRectangleBorder(\n+                borderRadius: BorderRadius.all(Radius.circular(10)),\n+              ),\n+            ),\n+          );\n+        }\n+\n+        // Pop immediately to return to the product list\n+        if (mounted) {\n+          Navigator.of(context).pop(true); // Return true to indicate success\n+        }\n       } else {\n         // Show error dialog\n-        showDialog(\n-          context: context,\n-          builder: (BuildContext context) {\n-            return AlertDialog(\n-              title: const Text('Error'),\n-              content: Text(productProvider.errorMessage),\n-              actions: [\n-                TextButton(\n-                  onPressed: () {\n-                    Navigator.of(context).pop();\n-                  },\n-                  child: const Text('OK'),\n-                ),\n-              ],\n-            );\n-          },\n-        );\n+        if (mounted) {\n+          showDialog(\n+            context: context,\n+            builder: (BuildContext context) {\n+              return AlertDialog(\n+                title: const Text('Error'),\n+                content: Text(productProvider.errorMessage),\n+                actions: [\n+                  TextButton(\n+                    onPressed: () {\n+                      Navigator.of(context).pop();\n+                    },\n+                    child: const Text('OK'),\n+                  ),\n+                ],\n+              );\n+            },\n+          );\n+        }\n       }\n     }\n   }\n \n@@ -125,128 +125,126 @@\n         title: const Text('Add Product'),\n         backgroundColor: Theme.of(context).primaryColor,\n         foregroundColor: Colors.white,\n       ),\n-      body: Consumer<ProductProvider>(\n-        builder: (context, provider, child) {\n-          return SingleChildScrollView(\n-            padding: const EdgeInsets.all(16.0),\n-            child: Form(\n-              key: _formKey,\n+      body: _isUploading\n+          ? const Center(\n               child: Column(\n-                crossAxisAlignment: CrossAxisAlignment.stretch,\n+                mainAxisAlignment: MainAxisAlignment.center,\n                 children: [\n-                  // Product Type Dropdown\n-                  DropdownButtonFormField<String>(\n-                    initialValue: _selectedProductType,\n-                    hint: const Text('Select Product Type'),\n-                    items: _productTypes.map((String type) {\n-                      return DropdownMenuItem(value: type, child: Text(type));\n-                    }).toList(),\n-                    validator: (value) =>\n-                        value == null ? 'Please select a product type' : null,\n-                    onChanged: (value) {\n-                      setState(() {\n-                        _selectedProductType = value;\n-                      });\n-                    },\n-                  ),\n-                  const SizedBox(height: 16),\n+                  SpinKitCircle(color: Colors.blue, size: 50.0),\n+                  SizedBox(height: 20),\n+                  Text('Uploading product...', style: TextStyle(fontSize: 18)),\n+                ],\n+              ),\n+            )\n+          : SingleChildScrollView(\n+              padding: const EdgeInsets.all(16.0),\n+              child: Form(\n+                key: _formKey,\n+                child: Column(\n+                  crossAxisAlignment: CrossAxisAlignment.stretch,\n+                  children: [\n+                    // Product Type Dropdown\n+                    DropdownButtonFormField<String>(\n+                      value: _selectedProductType,\n+                      hint: const Text('Select Product Type'),\n+                      items: _productTypes.map((String type) {\n+                        return DropdownMenuItem(value: type, child: Text(type));\n+                      }).toList(),\n+                      validator: (value) =>\n+                          value == null ? 'Please select a product type' : null,\n+                      onChanged: (value) {\n+                        setState(() {\n+                          _selectedProductType = value;\n+                        });\n+                      },\n+                    ),\n+                    const SizedBox(height: 16),\n \n-                  // Product Name\n-                  TextFormField(\n-                    controller: _productNameController,\n-                    decoration: const InputDecoration(\n-                      labelText: 'Product Name',\n-                      border: OutlineInputBorder(),\n+                    // Product Name\n+                    TextFormField(\n+                      controller: _productNameController,\n+                      decoration: const InputDecoration(\n+                        labelText: 'Product Name',\n+                        border: OutlineInputBorder(),\n+                      ),\n+                      validator: (value) => value == null || value.isEmpty\n+                          ? 'Please enter product name'\n+                          : null,\n                     ),\n-                    validator: (value) => value == null || value.isEmpty\n-                        ? 'Please enter product name'\n-                        : null,\n-                  ),\n-                  const SizedBox(height: 16),\n+                    const SizedBox(height: 16),\n \n-                  // Price\n-                  TextFormField(\n-                    controller: _priceController,\n-                    decoration: const InputDecoration(\n-                      labelText: 'Selling Price',\n-                      border: OutlineInputBorder(),\n-                      prefixText: '₹ ',\n+                    // Price\n+                    TextFormField(\n+                      controller: _priceController,\n+                      decoration: const InputDecoration(\n+                        labelText: 'Selling Price',\n+                        border: OutlineInputBorder(),\n+                        prefixText: '₹ ',\n+                      ),\n+                      keyboardType: TextInputType.numberWithOptions(\n+                        decimal: true,\n+                      ),\n+                      validator: (value) => value == null || value.isEmpty\n+                          ? 'Please enter price'\n+                          : null,\n                     ),\n-                    keyboardType: const TextInputType.numberWithOptions(\n-                      decimal: true,\n-                    ),\n-                    validator: (value) => value == null || value.isEmpty\n-                        ? 'Please enter price'\n-                        : null,\n-                  ),\n-                  const SizedBox(height: 16),\n+                    const SizedBox(height: 16),\n \n-                  // Tax\n-                  TextFormField(\n-                    controller: _taxController,\n-                    decoration: const InputDecoration(\n-                      labelText: 'Tax Rate (%)',\n-                      border: OutlineInputBorder(),\n-                      suffixText: '%',\n+                    // Tax\n+                    TextFormField(\n+                      controller: _taxController,\n+                      decoration: const InputDecoration(\n+                        labelText: 'Tax Rate (%)',\n+                        border: OutlineInputBorder(),\n+                        suffixText: '%',\n+                      ),\n+                      keyboardType: TextInputType.numberWithOptions(\n+                        decimal: true,\n+                      ),\n+                      validator: (value) => value == null || value.isEmpty\n+                          ? 'Please enter tax rate'\n+                          : null,\n                     ),\n-                    keyboardType: const TextInputType.numberWithOptions(\n-                      decimal: true,\n-                    ),\n-                    validator: (value) => value == null || value.isEmpty\n-                        ? 'Please enter tax rate'\n-                        : null,\n-                  ),\n-                  const SizedBox(height: 16),\n+                    const SizedBox(height: 16),\n \n-                  // Image Picker\n-                  GestureDetector(\n-                    onTap: _pickImage,\n-                    child: Container(\n-                      height: 150,\n-                      decoration: BoxDecoration(\n-                        border: Border.all(color: Colors.grey),\n-                        borderRadius: BorderRadius.circular(8),\n-                      ),\n-                      child: _selectedImage == null\n-                          ? const Column(\n-                              mainAxisAlignment: MainAxisAlignment.center,\n-                              children: [\n-                                Icon(\n-                                  Icons.add_a_photo,\n-                                  size: 50,\n-                                  color: Colors.grey,\n+                    // Image Picker\n+                    GestureDetector(\n+                      onTap: _pickImage,\n+                      child: Container(\n+                        height: 150,\n+                        decoration: BoxDecoration(\n+                          border: Border.all(color: Colors.grey),\n+                          borderRadius: BorderRadius.circular(8),\n+                        ),\n+                        child: _selectedImage == null\n+                            ? const Column(\n+                                mainAxisAlignment: MainAxisAlignment.center,\n+                                children: [\n+                                  Icon(\n+                                    Icons.add_a_photo,\n+                                    size: 50,\n+                                    color: Colors.grey,\n+                                  ),\n+                                  SizedBox(height: 10),\n+                                  Text('Tap to select image (Optional)'),\n+                                ],\n+                              )\n+                            : ClipRRect(\n+                                borderRadius: BorderRadius.circular(8),\n+                                child: Image.file(\n+                                  _selectedImage!,\n+                                  fit: BoxFit.cover,\n+                                  width: double.infinity,\n+                                  height: double.infinity,\n                                 ),\n-                                SizedBox(height: 10),\n-                                Text('Tap to select image (Optional)'),\n-                              ],\n-                            )\n-                          : ClipRRect(\n-                              borderRadius: BorderRadius.circular(8),\n-                              child: Image.file(\n-                                _selectedImage!,\n-                                fit: BoxFit.cover,\n-                                width: double.infinity,\n-                                height: double.infinity,\n                               ),\n-                            ),\n+                      ),\n                     ),\n-                  ),\n-                  const SizedBox(height: 24),\n+                    const SizedBox(height: 24),\n \n-                  // Submit Button\n-                  if (_isUploading)\n-                    const Center(\n-                      child: Column(\n-                        children: [\n-                          SpinKitCircle(color: Colors.blue, size: 50.0),\n-                          SizedBox(height: 10),\n-                          Text('Uploading product...'),\n-                        ],\n-                      ),\n-                    )\n-                  else\n+                    // Submit Button\n                     ElevatedButton(\n                       onPressed: _submitForm,\n                       style: ElevatedButton.styleFrom(\n                         padding: const EdgeInsets.all(16),\n@@ -258,13 +256,11 @@\n                         'Add Product',\n                         style: TextStyle(fontSize: 18),\n                       ),\n                     ),\n-                ],\n+                  ],\n+                ),\n               ),\n             ),\n-          );\n-        },\n-      ),\n     );\n   }\n }\n"
                },
                {
                    "date": 1764491469037,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,9 +27,8 @@\n   final ImagePicker _picker = ImagePicker();\n \n   final List<String> _productTypes = ['Product', 'Service'];\n \n-  // Function to pick image from gallery\n   Future<void> _pickImage() async {\n     final XFile? pickedFile = await _picker.pickImage(\n       source: ImageSource.gallery,\n       imageQuality: 80,\n"
                },
                {
                    "date": 1764491476308,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,8 @@\n         _isUploading = false;\n       });\n \n       if (success) {\n-        // Show success snackbar\n         if (mounted) {\n           ScaffoldMessenger.of(context).showSnackBar(\n             const SnackBar(\n               content: Text('Product added successfully!'),\n"
                },
                {
                    "date": 1764491483184,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,11 +78,10 @@\n             ),\n           );\n         }\n \n-        // Pop immediately to return to the product list\n         if (mounted) {\n-          Navigator.of(context).pop(true); // Return true to indicate success\n+          Navigator.of(context).pop(true); /s\n         }\n       } else {\n         // Show error dialog\n         if (mounted) {\n"
                },
                {
                    "date": 1764491488735,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,12 +79,11 @@\n           );\n         }\n \n         if (mounted) {\n-          Navigator.of(context).pop(true); /s\n+          Navigator.of(context).pop(true); \n         }\n       } else {\n-        // Show error dialog\n         if (mounted) {\n           showDialog(\n             context: context,\n             builder: (BuildContext context) {\n"
                },
                {
                    "date": 1764491513495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -177,9 +177,9 @@\n                         labelText: 'Selling Price',\n                         border: OutlineInputBorder(),\n                         prefixText: '₹ ',\n                       ),\n-                      keyboardType: TextInputType.numberWithOptions(\n+                      keyboardType: const TextInputType.numberWithOptions(\n                         decimal: true,\n                       ),\n                       validator: (value) => value == null || value.isEmpty\n                           ? 'Please enter price'\n@@ -194,9 +194,9 @@\n                         labelText: 'Tax Rate (%)',\n                         border: OutlineInputBorder(),\n                         suffixText: '%',\n                       ),\n-                      keyboardType: TextInputType.numberWithOptions(\n+                      keyboardType: const TextInputType.numberWithOptions(\n                         decimal: true,\n                       ),\n                       validator: (value) => value == null || value.isEmpty\n                           ? 'Please enter tax rate'\n"
                }
            ],
            "date": 1764487585808,
            "name": "Commit-0",
            "content": "import 'dart:io';\n\nimport 'package:flutter/material.dart';\nimport 'package:flutter_spinkit/flutter_spinkit.dart';\nimport 'package:form_field_validator/form_field_validator.dart';\nimport 'package:image_picker/image_picker.dart';\nimport 'package:provider/provider.dart';\n\nimport '../providers/product_provider.dart';\n\nclass AddProductScreen extends StatefulWidget {\n  const AddProductScreen({Key? key}) : super(key: key);\n\n  @override\n  State<AddProductScreen> createState() => _AddProductScreenState();\n}\n\nclass _AddProductScreenState extends State<AddProductScreen> {\n  final _formKey = GlobalKey<FormState>();\n  final _productNameController = TextEditingController();\n  final _priceController = TextEditingController();\n  final _taxController = TextEditingController();\n\n  String? _selectedProductType;\n  File? _selectedImage;\n  bool _isUploading = false;\n\n  final ImagePicker _picker = ImagePicker();\n\n  final List<String> _productTypes = ['Product', 'Service'];\n\n  // Function to pick image from gallery\n  Future<void> _pickImage() async {\n    final XFile? pickedFile = await _picker.pickImage(\n      source: ImageSource.gallery,\n      imageQuality: 80,\n    );\n\n    if (pickedFile != null) {\n      setState(() {\n        _selectedImage = File(pickedFile.path);\n      });\n    }\n  }\n\n  void _submitForm() async {\n    if (_formKey.currentState!.validate()) {\n      setState(() {\n        _isUploading = true;\n      });\n\n      final productProvider = Provider.of<ProductProvider>(\n        context,\n        listen: false,\n      );\n\n      final success = await productProvider.addProduct(\n        productName: _productNameController.text,\n        productType: _selectedProductType!,\n        price: _priceController.text,\n        tax: _taxController.text,\n        image: _selectedImage,\n      );\n\n      setState(() {\n        _isUploading = false;\n      });\n\n      if (success) {\n        // Show success dialog\n        showDialog(\n          context: context,\n          builder: (BuildContext context) {\n            return AlertDialog(\n              title: const Text('Success'),\n              content: const Text('Product added successfully!'),\n              actions: [\n                TextButton(\n                  onPressed: () {\n                    Navigator.of(context).pop();\n                    Navigator.of(\n                      context,\n                    ).pop(true); // Return true to indicate success\n                  },\n                  child: const Text('OK'),\n                ),\n              ],\n            );\n          },\n        );\n      } else {\n        // Show error dialog\n        showDialog(\n          context: context,\n          builder: (BuildContext context) {\n            return AlertDialog(\n              title: const Text('Error'),\n              content: Text(productProvider.errorMessage),\n              actions: [\n                TextButton(\n                  onPressed: () {\n                    Navigator.of(context).pop();\n                  },\n                  child: const Text('OK'),\n                ),\n              ],\n            );\n          },\n        );\n      }\n    }\n  }\n\n  @override\n  void dispose() {\n    _productNameController.dispose();\n    _priceController.dispose();\n    _taxController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Add Product'),\n        backgroundColor: Theme.of(context).primaryColor,\n        foregroundColor: Colors.white,\n      ),\n      body: Consumer<ProductProvider>(\n        builder: (context, provider, child) {\n          return SingleChildScrollView(\n            padding: const EdgeInsets.all(16.0),\n            child: Form(\n              key: _formKey,\n              child: Column(\n                crossAxisAlignment: CrossAxisAlignment.stretch,\n                children: [\n                  // Product Type Dropdown\n                  DropdownButtonFormField<String>(\n                    value: _selectedProductType,\n                    hint: const Text('Select Product Type'),\n                    items: _productTypes.map((String type) {\n                      return DropdownMenuItem(value: type, child: Text(type));\n                    }).toList(),\n                    validator: (value) =>\n                        value == null ? 'Please select a product type' : null,\n                    onChanged: (value) {\n                      setState(() {\n                        _selectedProductType = value;\n                      });\n                    },\n                  ),\n                  const SizedBox(height: 16),\n\n                  // Product Name\n                  TextFormField(\n                    controller: _productNameController,\n                    decoration: const InputDecoration(\n                      labelText: 'Product Name',\n                      border: OutlineInputBorder(),\n                    ),\n                    validator: (value) => value == null || value.isEmpty\n                        ? 'Please enter product name'\n                        : null,\n                  ),\n                  const SizedBox(height: 16),\n\n                  // Price\n                  TextFormField(\n                    controller: _priceController,\n                    decoration: const InputDecoration(\n                      labelText: 'Selling Price',\n                      border: OutlineInputBorder(),\n                      prefixText: '₹ ',\n                    ),\n                    keyboardType: TextInputType.numberWithOptions(\n                      decimal: true,\n                    ),\n                    validator: (value) => value == null || value.isEmpty\n                        ? 'Please enter price'\n                        : null,\n                  ),\n                  const SizedBox(height: 16),\n\n                  // Tax\n                  TextFormField(\n                    controller: _taxController,\n                    decoration: const InputDecoration(\n                      labelText: 'Tax Rate (%)',\n                      border: OutlineInputBorder(),\n                      suffixText: '%',\n                    ),\n                    keyboardType: TextInputType.numberWithOptions(\n                      decimal: true,\n                    ),\n                    validator: (value) => value == null || value.isEmpty\n                        ? 'Please enter tax rate'\n                        : null,\n                  ),\n                  const SizedBox(height: 16),\n\n                  // Image Picker\n                  GestureDetector(\n                    onTap: _pickImage,\n                    child: Container(\n                      height: 150,\n                      decoration: BoxDecoration(\n                        border: Border.all(color: Colors.grey),\n                        borderRadius: BorderRadius.circular(8),\n                      ),\n                      child: _selectedImage == null\n                          ? const Column(\n                              mainAxisAlignment: MainAxisAlignment.center,\n                              children: [\n                                Icon(\n                                  Icons.add_a_photo,\n                                  size: 50,\n                                  color: Colors.grey,\n                                ),\n                                SizedBox(height: 10),\n                                Text('Tap to select image (Optional)'),\n                              ],\n                            )\n                          : ClipRRect(\n                              borderRadius: BorderRadius.circular(8),\n                              child: Image.file(\n                                _selectedImage!,\n                                fit: BoxFit.cover,\n                                width: double.infinity,\n                                height: double.infinity,\n                              ),\n                            ),\n                    ),\n                  ),\n                  const SizedBox(height: 24),\n\n                  // Submit Button\n                  if (_isUploading)\n                    const Center(\n                      child: Column(\n                        children: [\n                          SpinKitCircle(color: Colors.blue, size: 50.0),\n                          SizedBox(height: 10),\n                          Text('Uploading product...'),\n                        ],\n                      ),\n                    )\n                  else\n                    ElevatedButton(\n                      onPressed: _submitForm,\n                      style: ElevatedButton.styleFrom(\n                        padding: const EdgeInsets.all(16),\n                        shape: RoundedRectangleBorder(\n                          borderRadius: BorderRadius.circular(30),\n                        ),\n                      ),\n                      child: const Text(\n                        'Add Product',\n                        style: TextStyle(fontSize: 18),\n                      ),\n                    ),\n                ],\n              ),\n            ),\n          );\n        },\n      ),\n    );\n  }\n}\n"
        }
    ]
}