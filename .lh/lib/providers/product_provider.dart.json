{
    "sourceFile": "lib/providers/product_provider.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1764491411081,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764491420756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n     _errorMessage = '';\n     notifyListeners();\n \n     try {\n-    \n+\n       final localProduct = LocalProduct(\n         productName: productName,\n         productType: productType,\n         price: double.parse(price),\n@@ -63,9 +63,9 @@\n \n       await HiveHelper.productsBox.add(localProduct);\n       _localProducts.add(localProduct);\n \n-      // Try to sync with API\n+      \n       final response = await _apiService.addProduct(\n         productName: productName,\n         productType: productType,\n         price: price,\n@@ -77,9 +77,9 @@\n         // Mark as synced\n         localProduct.isSynced = true;\n         await localProduct.save();\n \n-        // Also add to the main products list at the beginning\n+        \n         _products.insert(\n           0,\n           Product(\n             productName: productName,\n"
                },
                {
                    "date": 1764491427471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,8 @@\n       notifyListeners();\n     }\n   }\n \n-  // Filter products based on search query\n   List<Product> filterProducts(String query) {\n     if (query.isEmpty) {\n       return List.from(_products);\n     }\n"
                },
                {
                    "date": 1764491434811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,8 @@\n           product.productType.toLowerCase().contains(query.toLowerCase());\n     }).toList();\n   }\n \n-  // Sort products by price\n   List<Product> sortProductsByPrice(List<Product> products, bool ascending) {\n     final sortedProducts = List<Product>.from(products);\n     sortedProducts.sort(\n       (a, b) =>\n@@ -125,9 +124,8 @@\n     );\n     return sortedProducts;\n   }\n \n-  // Load local products\n   Future<void> loadLocalProducts() async {\n     _localProducts = HiveHelper.productsBox.values.toList();\n     notifyListeners();\n   }\n"
                }
            ],
            "date": 1764491411081,
            "name": "Commit-0",
            "content": "import 'dart:io';\n\nimport 'package:flutter/foundation.dart';\n\nimport '../models/local_product.dart';\nimport '../models/product.dart';\nimport '../services/api_service.dart';\nimport '../utils/hive_helper.dart';\n\nclass ProductProvider with ChangeNotifier {\n  final ApiService _apiService = ApiService();\n  List<Product> _products = [];\n  List<LocalProduct> _localProducts = [];\n  bool _isLoading = false;\n  String _errorMessage = '';\n  bool _isAddingProduct = false;\n\n  List<Product> get products => _products;\n  List<LocalProduct> get localProducts => _localProducts;\n  bool get isLoading => _isLoading;\n  String get errorMessage => _errorMessage;\n  bool get isAddingProduct => _isAddingProduct;\n\n  // Load products from API\n  Future<void> loadProducts() async {\n    _isLoading = true;\n    _errorMessage = '';\n    notifyListeners();\n\n    try {\n      final List<Product> fetchedProducts = await _apiService.getProducts();\n      _products = fetchedProducts;\n    } catch (e) {\n      _errorMessage = e.toString();\n    } finally {\n      _isLoading = false;\n      notifyListeners();\n    }\n  }\n\n  // Add a new product\n  Future<bool> addProduct({\n    required String productName,\n    required String productType,\n    required String price,\n    required String tax,\n    File? image,\n  }) async {\n    _isAddingProduct = true;\n    _errorMessage = '';\n    notifyListeners();\n\n    try {\n    \n      final localProduct = LocalProduct(\n        productName: productName,\n        productType: productType,\n        price: double.parse(price),\n        tax: double.parse(tax),\n        imagePath: image?.path,\n        isSynced: false,\n      );\n\n      await HiveHelper.productsBox.add(localProduct);\n      _localProducts.add(localProduct);\n\n      // Try to sync with API\n      final response = await _apiService.addProduct(\n        productName: productName,\n        productType: productType,\n        price: price,\n        tax: tax,\n        image: image,\n      );\n\n      if (response['success'] == true) {\n        // Mark as synced\n        localProduct.isSynced = true;\n        await localProduct.save();\n\n        // Also add to the main products list at the beginning\n        _products.insert(\n          0,\n          Product(\n            productName: productName,\n            productType: productType,\n            price: double.parse(price),\n            tax: double.parse(tax),\n            image: response['product_details']['image'] ?? '',\n          ),\n        );\n\n        notifyListeners();\n        return true;\n      } else {\n        _errorMessage = response['message'] ?? 'Failed to add product';\n        return false;\n      }\n    } catch (e) {\n      _errorMessage = e.toString();\n      return false;\n    } finally {\n      _isAddingProduct = false;\n      notifyListeners();\n    }\n  }\n\n  // Filter products based on search query\n  List<Product> filterProducts(String query) {\n    if (query.isEmpty) {\n      return List.from(_products);\n    }\n\n    return _products.where((product) {\n      return product.productName.toLowerCase().contains(query.toLowerCase()) ||\n          product.productType.toLowerCase().contains(query.toLowerCase());\n    }).toList();\n  }\n\n  // Sort products by price\n  List<Product> sortProductsByPrice(List<Product> products, bool ascending) {\n    final sortedProducts = List<Product>.from(products);\n    sortedProducts.sort(\n      (a, b) =>\n          ascending ? a.price.compareTo(b.price) : b.price.compareTo(a.price),\n    );\n    return sortedProducts;\n  }\n\n  // Load local products\n  Future<void> loadLocalProducts() async {\n    _localProducts = HiveHelper.productsBox.values.toList();\n    notifyListeners();\n  }\n}\n"
        }
    ]
}